---
import TabsButton from "@components/ui/TabsButton.astro";

import { AllJobs } from '../pages/api/jobs/posts'
import JobCard from "@components/JobCard.astro";
import Pagination from "@components/Pagination.astro";

import { JOBS_PER_PAGE } from '../constants'

const JobPosts: {}[] = AllJobs

const totalPages: number = Math.ceil(JobPosts.length / JOBS_PER_PAGE);

const currentPage: number | null  = +Astro.url.searchParams.get('page')! || 1;

const  JobsForPage = JobPosts.slice((currentPage - 1) * JOBS_PER_PAGE, currentPage * JOBS_PER_PAGE);

---

<div class="b border-gray-200 px-4 flex justify-center">
    <nav class="flex space-x-2" aria-label="Tabs" role="tablist">
        <TabsButton text='Job feed' tab="#basic-tabs-1"  active={true}/>
        <TabsButton text='Saved jobs' tab="#basic-tabs-2" active={false} />
      <hr>
    </nav>
</div>
  
<div class="mt-3 p-4">
    <div id="basic-tabs-1" role="tabpanel" aria-labelledby="basic-tabs-item-1">
        <div class="max-w-[85rem] px-4 py-10  lg:px-8 mx-auto ">
            <div class="items-center gap-12 shawdow-md">
                <div class="flex flex-col transition-all ease-in-out duration-300  max-w-[50rem] px-4 sm:px-3 lg:px-8 mx-auto">
                    {
                        JobsForPage.map(job =>
                            (
                                <JobCard job={job} />
                            )                  
                        )
                    }

                    <Pagination  currentPage={currentPage} totalPages={totalPages} disableNext={currentPage === totalPages} disablePrevious={currentPage === 1}/>
                </div>
            </div>
        </div>
    </div>

    <div id="basic-tabs-2" class="hidden" role="tabpanel" aria-labelledby="basic-tabs-item-2">
      <p class="max-w-[85rem] px-4 py-10  lg:px-8 mx-auto ">
       More code coming here
      </p>
    </div>
    
</div>